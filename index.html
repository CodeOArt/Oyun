<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Siber Savunma - Uzay NiÅŸancÄ±sÄ±</title>
    <script src="https://cdn.tailwindcss.com"></script>
    
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap');
        
        body {
            font-family: 'Inter', sans-serif;
            background-color: #0d1117;
            color: white;
            overflow-x: hidden;
            cursor: crosshair;
        }
        
        .game-screen {
            position: relative;
            width: 100%;
            height: 100vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            background: #0d1117; 
        }

        .game-ui {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            padding: 20px;
            display: flex;
            justify-content: space-between;
            z-index: 10;
        }
        
        .score-display, .lives-display, .ulti-display {
            background: rgba(0, 0, 0, 0.7);
            padding: 10px 20px;
            border-radius: 10px;
            font-size: 1.2rem;
            backdrop-filter: blur(5px);
            color: #00ffff;
            border: 1px solid #00ffff50;
        }
        
        .ulti-display.cooling-down {
            color: #ff0066;
            border-color: #ff006650;
        }
        
        .game-area {
            width: 100%;
            height: 100%;
            position: relative;
        }

        .player {
            position: absolute;
            bottom: 50px;
            left: 50%;
            transform: translateX(-50%);
            width: 60px;
            height: 60px;
            background: var(--skin-color, #3b82f6);
            border-radius: 50% 50% 0 0;
            box-shadow: 0 0 20px var(--skin-color, #3b82f6);
            transition: left 0.1s linear, box-shadow 0.3s ease, border 0.3s ease;
            z-index: 5;
            border: 3px solid transparent;
        }

        .player::before {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 50%;
            transform: translateX(-50%);
            width: 30px;
            height: 30px;
            background: var(--skin-color, #3b82f6);
            clip-path: polygon(50% 0%, 0% 100%, 100% 100%);
        }

        .enemy {
            position: absolute;
            width: 40px;
            height: 40px;
            background: #ff0066;
            border-radius: 50%;
            box-shadow: 0 0 15px #ff0066;
        }

        .meteor {
            position: absolute;
            width: 20px;
            height: 60px;
            background: linear-gradient(to bottom, #ffae00, #ff4d00);
            border-radius: 10px;
            box-shadow: 0 0 20px #ff9900;
            opacity: 0.9;
        }

        .bullet {
            position: absolute;
            width: 5px;
            height: 15px;
            background: #00ff99;
            border-radius: 5px;
            box-shadow: 0 0 10px #00ff99;
        }

        .explosion {
            position: absolute;
            width: 50px;
            height: 50px;
            background: radial-gradient(circle, #ff9900, #ff3300);
            border-radius: 50%;
            animation: explode 0.5s forwards;
            z-index: 99;
        }

        @keyframes explode {
            0% { transform: scale(0); opacity: 1; }
            100% { transform: scale(2); opacity: 0; }
        }

        .stars {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
        }

        .star {
            position: absolute;
            background: white;
            border-radius: 50%;
            animation: twinkle 5s infinite;
        }

        @keyframes twinkle {
            0%, 100% { opacity: 0.2; }
            50% { opacity: 1; }
        }
        
        .hidden {
            display: none !important;
        }
    </style>
</head>
<body>
    <div class="min-h-screen bg-gray-950 text-white font-sans">
        <div class="fixed inset-0 z-0 opacity-5">
            <div class="bg-repeat h-full w-full" style="background-image: radial-gradient(#2d3748 1px, transparent 1px); background-size: 40px 40px;"></div>
        </div>
        
        <div class="relative z-10 max-w-6xl mx-auto px-4 py-8">
            <div id="menuScreen" class="flex flex-col items-center justify-center text-center h-[70vh] p-8">
                <div class="bg-gray-900 p-10 rounded-2xl border-4 border-blue-500/50 shadow-2xl shadow-blue-800/50 backdrop-blur-sm">
                    <h1 class="text-6xl font-extrabold text-white tracking-tighter mb-2 animate-pulse">
                        <span class='text-red-500'>SÄ°BER</span> <span class='text-blue-400'>SAVUNMA</span>
                    </h1>
                    <p class="text-xl font-mono text-gray-400 mb-8">Uzay NiÅŸancÄ±sÄ± | MuÅŸ Ãœniversitesi Projesi</p>
                    
                    <div id="welcomeMessage" class="mb-6 text-red-400 font-semibold text-lg">
                        Sunucuya baÄŸlanÄ±lÄ±yor...
                    </div>

                    <div class="space-y-4 max-w-xs mx-auto">
                        <button id="startGameBtn" class="px-8 py-3 rounded-xl font-bold uppercase tracking-wider transition-all duration-300 transform bg-indigo-600 text-white shadow-lg shadow-indigo-500/50 hover:bg-indigo-700 active:scale-95 w-full opacity-50 cursor-not-allowed" disabled>
                            Oturum Gerekli
                        </button>
                        <button id="rankingBtn" class="px-8 py-3 rounded-xl font-bold uppercase tracking-wider transition-all duration-300 transform bg-gray-700 text-gray-200 hover:bg-gray-600 active:scale-95 w-full">
                            ğŸ† Galaksi SÄ±ralamasÄ±
                        </button>
                        <button id="marketBtn" class="px-8 py-3 rounded-xl font-bold uppercase tracking-wider transition-all duration-300 transform bg-gray-700 text-gray-200 hover:bg-gray-600 active:scale-95 w-full">
                            ğŸ›’ Gemi PazarÄ±
                        </button>
                        <button id="aboutBtn" class="px-8 py-3 rounded-xl font-bold uppercase tracking-wider transition-all duration-300 transform bg-gray-700 text-gray-200 hover:bg-gray-600 active:scale-95 w-full">
                            ğŸ“š HakkÄ±mÄ±zda
                        </button>
                         <button id="logoutBtn" class="px-8 py-3 rounded-xl font-bold uppercase tracking-wider transition-all duration-300 transform bg-red-800 text-gray-200 hover:bg-red-700 active:scale-95 w-full hidden">
                            Ã‡Ä±kÄ±ÅŸ Yap
                        </button>
                    </div>
                </div>
            </div>
            
            <div id="gameScreen" class="hidden">
                <div class="game-screen">
                    <div class="game-ui">
                        <div class="score-display">SKOR: <span id="scoreValue">0</span></div>
                        <div class="ulti-display hidden" id="ultiDisplay">ULTÄ°: <span id="ultiStatus">HAZIR</span></div>
                        <div class="lives-display">CAN: <span id="livesValue">3</span></div>
                    </div>
                    <div class="game-area" id="gameArea">
                        <div class="stars" id="starsContainer"></div>
                        <div class="player" id="player"></div>
                    </div>
                </div>
            </div>
            
            <div id="gameOverScreen" class="hidden flex flex-col items-center justify-center text-center h-[70vh] p-8">
                <div class="bg-gray-900 p-10 rounded-2xl border-4 border-red-500 shadow-2xl shadow-red-800/50 backdrop-blur-sm">
                    <h2 class="text-5xl font-extrabold text-red-500 mb-4">MÄ°SYON SONA ERDÄ°!</h2>
                    <p class="text-3xl font-mono text-white mb-6">KazanÄ±lan Puan: <span id="finalScore" class="text-yellow-400 font-extrabold">0</span></p>
                    <div class='text-gray-400 mb-8'>
                        <p>Skorunuz sÄ±ralama ve toplam puanÄ±nÄ±za eklendi.</p>
                    </div>
                    <div class="space-y-4 max-w-xs mx-auto">
                        <button id="returnToMenuBtn" class="px-8 py-3 rounded-xl font-bold uppercase tracking-wider transition-all duration-300 transform bg-green-600 text-white shadow-lg shadow-green-500/50 hover:bg-green-700 active:scale-95 w-full">
                            MenÃ¼ye DÃ¶n
                        </button>
                        <button id="viewRankingBtn" class="px-8 py-3 rounded-xl font-bold uppercase tracking-wider transition-all duration-300 transform bg-gray-700 text-gray-200 hover:bg-gray-600 active:scale-95 w-full">
                            ğŸ† SÄ±ralamayÄ± GÃ¶r
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <div id="usernameModal" class="fixed inset-0 bg-gray-900 bg-opacity-90 z-50 flex items-center justify-center p-4">
            <div class="bg-gray-800 text-white rounded-xl shadow-2xl w-full max-w-lg overflow-y-auto max-h-[90vh] border border-blue-500/50">
                <div class="p-6">
                    <div class="flex justify-between items-center mb-4 border-b border-gray-700 pb-3">
                        <h2 class="text-2xl font-extrabold text-blue-400">Pilot KayÄ±t Merkezi</h2>
                          </div>
                    <p class="mb-4 text-gray-300">SÄ±ralama listesinde ve oyunda gÃ¶rÃ¼nmek iÃ§in benzersiz bir kullanÄ±cÄ± adÄ± girin (Maks. 15 karakter):</p>
                    <form id="usernameForm" class="flex gap-2">
                        <input
                            id="usernameInput"
                            name="username"
                            type="text"
                            maxlength="15"
                            placeholder="Oyuncu AdÄ±"
                            class="flex-grow p-3 bg-gray-700 border border-blue-500 rounded-lg text-white placeholder-gray-400 focus:ring-2 focus:ring-blue-400"
                            autofocus
                        />
                        <button type="submit" id="usernameSubmitBtn" class="px-8 py-3 rounded-xl font-bold uppercase tracking-wider transition-all duration-300 transform bg-indigo-600 text-white shadow-lg shadow-indigo-500/50 hover:bg-indigo-700 active:scale-95">
                            Kaydet
                        </button>
                    </form>
                    <p id="usernameError" class="mt-4 text-sm text-red-400 hidden"></p>
                </div>
            </div>
        </div>

        <div id="rankingModal" class="fixed inset-0 bg-gray-900 bg-opacity-90 z-50 flex items-center justify-center p-4 hidden">
            <div class="bg-gray-800 text-white rounded-xl shadow-2xl w-full max-w-2xl overflow-y-auto max-h-[90vh] border border-blue-500/50">
                <div class="p-6">
                    <div class="flex justify-between items-center mb-4 border-b border-gray-700 pb-3">
                        <h2 class="text-2xl font-extrabold text-blue-400">ğŸ† Galaksi SÄ±ralamasÄ± (Top 20)</h2>
                        <button id="closeRankingModal" class="text-gray-400 hover:text-white transition duration-200 text-3xl leading-none">&times;</button>
                    </div>
                    <p class='text-gray-400 mb-4'>En yÃ¼ksek tek oyun skorlarÄ±.</p>
                    <div id="rankingContent" class="overflow-x-auto">
                        <div class="text-center py-8 text-blue-400">SÄ±ralama yÃ¼kleniyor...</div>
                    </div>
                </div>
            </div>
        </div>

        <div id="marketModal" class="fixed inset-0 bg-gray-900 bg-opacity-90 z-50 flex items-center justify-center p-4 hidden">
            <div class="bg-gray-800 text-white rounded-xl shadow-2xl w-full max-w-lg overflow-y-auto max-h-[90vh] border border-blue-500/50">
                <div class="p-6">
                    <div class="flex justify-between items-center mb-4 border-b border-gray-700 pb-3">
                        <h2 class="text-2xl font-extrabold text-blue-400">ğŸ›’ Gemi PazarÄ±</h2>
                        <button id="closeMarketModal" class="text-gray-400 hover:text-white transition duration-200 text-3xl leading-none">&times;</button>
                    </div>
                    <div id="marketContent" class="text-lg font-bold mb-4 text-center text-yellow-400">
                        Toplam PuanÄ±nÄ±z: <span id="totalScore">0</span>
                    </div>
                    <div id="skinsContainer" class="space-y-4">
                        <div class="text-center py-4 text-gray-400">Ã–nce giriÅŸ yapmalÄ±sÄ±n...</div>
                    </div>
                    <p class="mt-6 text-sm text-gray-400">Marketten aldÄ±ÄŸÄ±nÄ±z skinler kalÄ±cÄ±dÄ±r ve Toplam PuanÄ±nÄ±zdan dÃ¼ÅŸÃ¼lÃ¼r.</p>
                </div>
            </div>
        </div>

        <div id="aboutModal" class="fixed inset-0 bg-gray-900 bg-opacity-90 z-50 flex items-center justify-center p-4 hidden">
            <div class="bg-gray-800 text-white rounded-xl shadow-2xl w-full max-w-lg overflow-y-auto max-h-[90vh] border border-blue-500/50">
                <div class="p-6">
                    <div class="flex justify-between items-center mb-4 border-b border-gray-700 pb-3">
                        <h2 class="text-2xl font-extrabold text-blue-400">HakkÄ±mÄ±zda</h2>
                        <button id="closeAboutModal" class="text-gray-400 hover:text-white transition duration-200 text-3xl leading-none">&times;</button>
                    </div>
                    <div class="space-y-4 text-gray-300">
                        <h3 class="text-xl font-bold text-blue-400">Proje AdÄ±: MUÅ SÄ°BER SAVUNMA (UZAY TEMASI)</h3>
                        <p>
                            **GeliÅŸtirme AmacÄ±:** MuÅŸ Alparslan ÃœniversitesiiÃ§in Web TabanlÄ± Oyun GeliÅŸtirme dersi/projesi kapsamÄ±nda, yÃ¼ksek performanslÄ± DOM/CSS animasyonlarÄ± ve modern web teknolojilerini kullanan profesyonel bir Ã¶rnek olarak hazÄ±rlanmÄ±ÅŸtÄ±r.
                        </p>
                        <div class="border-t border-gray-700 pt-3">
                            <h4 class="font-semibold text-white">YapÄ±mcÄ±lar:</h4>
                            <ul class="list-disc list-inside ml-4">
                                <li>Halil Ä°brahim Eskici</li>
                                <li>---</li>
                                <li>--- 3</li>
                            </ul>
                        </div>
                        <p class="text-xs text-gray-500">
                            **Not:** Oyun, JavaScript DOM ile kontrol edilmektedir.
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // --- YENÄ° EKLENDÄ°: FIREBASE CONFIG ---
        // Kendi Firebase proje ayarlarÄ±nÄ± buraya yapÄ±ÅŸtÄ±r
        const firebaseConfig = {
            apiKey: "AIzaSyCtxhaGd7CgBvfQMLNOYkfjGdouMYH9fIE", // ESKÄ°SÄ°NÄ° KULLANMA!
            authDomain: "oyun-e145e.firebaseapp.com",
            projectId: "oyun-e145e",
            storageBucket: "oyun-e145e.appspot.com", // 'firebasestorage' deÄŸil, .appspot.com olmalÄ±
            messagingSenderId: "600558322843",
            appId: "1:600558322843:web:ea7c2bf5d5fb81f95d323e"
            // databaseURL'e gerek yok, Firestore kullanÄ±yoruz
        };

        // Firebase'i baÅŸlat
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();
        const auth = firebase.auth();


        // --- SABÄ°T DEÄÄ°ÅKENLER VE AYARLAR ---
        const GAME_DURATION = 45;
        const SCORE_MULTIPLIER = 10;
        const INITIAL_HEALTH = 3;
        const ENEMY_SPAWN_INTERVAL = 1000;
        const BULLET_SPAWN_INTERVAL = 300;
        const ULTI_COOLDOWN = 60000; 

        const SKIN_PRICES = [
            { id: 'default', name: 'VarsayÄ±lan Gemi', price: 0, color: '#3b82f6' },
            { id: 'red_fighter', name: 'KÄ±zÄ±l AvcÄ± (Ulti: TaramalÄ±)', price: 500, color: '#ef4444' },
            { id: 'green_defender', name: 'YeÅŸil Savunucu (Ulti: Kalkan)', price: 5000, color: '#10b981' },
            { id: 'yellow_blaster', name: 'SarÄ± PatlatÄ±cÄ± (Ulti: Bomba)', price: 50000, color: '#f59e0b' }
        ];

        // --- OYUN DEÄÄ°ÅKENLERÄ° ---
        let gameState = 'MENU';
        let currentUserId = null; // YENÄ°: Firebase user ID'sini tutar
        let userName = '';
        
        // YENÄ°: userProfile artÄ±k Firebase'den yÃ¼klenen varsayÄ±lan bir nesne
        let userProfile = {
            username: '',
            totalScore: 0,
            unlockedSkins: ['default'],
            currentSkin: 'default'
        };

        let gameVars = {
            gameActive: false,
            score: 0,
            lives: INITIAL_HEALTH,
            enemies: [],
            bullets: [],
            animationId: null,
            lastEnemyTime: 0,
            lastBulletTime: 0,
            playerX: 0,
            playerY: 0,
            timerInterval: null,
            timeLeft: GAME_DURATION,
            ultiReady: true,
            isShieldActive: false,
            isRapidFireActive: false,
            lastUltiTime: 0
        };

        // --- DOM ELEMENTLERÄ° ---
        const menuScreen = document.getElementById('menuScreen');
        const gameScreen = document.getElementById('gameScreen');
        const gameOverScreen = document.getElementById('gameOverScreen');
        const usernameModal = document.getElementById('usernameModal');
        const rankingModal = document.getElementById('rankingModal');
        const marketModal = document.getElementById('marketModal');
        const aboutModal = document.getElementById('aboutModal');
        const gameArea = document.getElementById('gameArea');
        const player = document.getElementById('player');
        const starsContainer = document.getElementById('starsContainer');
        const scoreValue = document.getElementById('scoreValue');
        const livesValue = document.getElementById('livesValue');
        const finalScore = document.getElementById('finalScore');
        const totalScore = document.getElementById('totalScore');
        const welcomeMessage = document.getElementById('welcomeMessage');
        const startGameBtn = document.getElementById('startGameBtn');
        const skinsContainer = document.getElementById('skinsContainer');
        const ultiDisplay = document.getElementById('ultiDisplay');
        const ultiStatus = document.getElementById('ultiStatus');
        const logoutBtn = document.getElementById('logoutBtn');
        const usernameForm = document.getElementById('usernameForm');
        const usernameInput = document.getElementById('usernameInput');
        const usernameError = document.getElementById('usernameError');
        const usernameSubmitBtn = document.getElementById('usernameSubmitBtn');


        // --- YENÄ° EKLENDÄ°: FIREBASE API (TEMÄ°ZLENMÄ°Å VERSÄ°YON) ---
        
        const firebaseAPI = {
            // KullanÄ±cÄ± adÄ± veritabanÄ±nda var mÄ± diye kontrol et
            checkUsernameExists: async (username) => {
                console.log(`Firebase'de kontrol ediliyor: ${username}`);
                // GERÃ‡EK KOD: 'usernames' koleksiyonunda bu isimde bir dokÃ¼man var mÄ± diye bak.
                const snapshot = await db.collection('usernames').doc(username).get();
                return snapshot.exists;
            },

            // Yeni kullanÄ±cÄ± iÃ§in profil ve kullanÄ±cÄ± adÄ± oluÅŸtur
            createUserProfile: async (uid, username) => {
                console.log(`Firebase'e kaydediliyor: ${uid} -> ${username}`);
                const defaultProfile = {
                    username: username,
                    totalScore: 0,
                    unlockedSkins: ['default'],
                    currentSkin: 'default'
                };
                
                // GERÃ‡EK KOD: Ä°ki iÅŸlemi aynÄ± anda yapmak iÃ§in 'batch' (toplu iÅŸlem) kullan.
                const batch = db.batch();
                
                // 1. KullanÄ±cÄ± adÄ±nÄ± 'usernames' koleksiyonuna ekle (hÄ±zlÄ± kontrol iÃ§in)
                const usernameRef = db.collection('usernames').doc(username);
                batch.set(usernameRef, { uid: uid });
                
                // 2. KullanÄ±cÄ±nÄ±n profilini 'users' koleksiyonuna ekle
                const userRef = db.collection('users').doc(uid);
                batch.set(userRef, defaultProfile);
                
                // Her iki iÅŸlemi de gerÃ§ekleÅŸtir
                await batch.commit();
                
                return defaultProfile;
            },

            // Firebase'den kullanÄ±cÄ± profilini yÃ¼kle
            loadUserProfile: async (uid) => {
                console.log(`Firebase'den yÃ¼kleniyor: ${uid}`);
                
                // GERÃ‡EK KOD: KullanÄ±cÄ±nÄ±n profil belgesini ID'sine gÃ¶re Ã§ek.
                const doc = await db.collection('users').doc(uid).get();
                if (doc.exists) {
                    return doc.data();
                } else {
                    // KullanÄ±cÄ± var ama profili yoksa (anormal durum)
                    console.error("Hata: KullanÄ±cÄ± profili bulunamadÄ±!", uid);
                    return null; 
                }
            },

            // Oyuncunun toplam skorunu gÃ¼ncelle
            updateTotalScore: async (uid, newTotalScore) => {
                console.log(`Firebase gÃ¼ncelleniyor: ${uid} -> totalScore: ${newTotalScore}`);
                // GERÃ‡EK KOD: Sadece 'totalScore' alanÄ±nÄ± gÃ¼ncelle.
                await db.collection('users').doc(uid).update({ totalScore: newTotalScore });
            },

            // Yeni bir yÃ¼ksek skoru sÄ±ralamaya ekle
            saveGameScore: async (username, score) => {
                if (score <= 0) return; // 0 puanÄ± kaydetme
                console.log(`Firebase'e skor kaydediliyor: ${username} -> ${score}`);
                // GERÃ‡EK KOD: 'highscores' koleksiyonuna yeni bir belge ekle.
                await db.collection('highscores').add({
                    username: username,
                    score: score,
                    timestamp: firebase.firestore.FieldValue.serverTimestamp() // Sunucu saatini kullan
                });
            },

            // SÄ±ralama listesini (en yÃ¼ksek 20) Firebase'den Ã§ek
            getHighScores: async () => {
                console.log("Firebase'den sÄ±ralama Ã§ekiliyor...");
                // GERÃ‡EK KOD: 'highscores' koleksiyonunu skora gÃ¶re (bÃ¼yÃ¼kten kÃ¼Ã§Ã¼ÄŸe) sÄ±rala ve ilk 20'yi al.
                const snapshot = await db.collection('highscores')
                                        .orderBy('score', 'desc')
                                        .limit(20)
                                        .get();
                // DatalarÄ± bir diziye Ã§evirip dÃ¶ndÃ¼r.
                return snapshot.docs.map(doc => doc.data());
            },
            
            // Skinleri ve puanÄ± kaydet (market alÄ±ÅŸveriÅŸi sonrasÄ±)
            saveUserProfileData: async (uid, profileData) => {
                console.log(`Firebase'e profil kaydediliyor: ${uid}`);
                // GERÃ‡EK KOD: GÃ¶nderilen profil verisini (Ã¶rn: { currentSkin: 'id' }) gÃ¼ncelle.
                await db.collection('users').doc(uid).update(profileData);
            }
        };


        // --- OYUN BAÅLATMA ---
        document.addEventListener('DOMContentLoaded', function() {
            setupEventListeners();
            createStars();
            
            // YENÄ°: Firebase Auth durumunu dinle
            auth.onAuthStateChanged(async (user) => {
                if (user) {
                    // KullanÄ±cÄ± giriÅŸ yapmÄ±ÅŸ
                    currentUserId = user.uid;
                    
                    // Profili yÃ¼kle
                    const profile = await firebaseAPI.loadUserProfile(currentUserId);
                    if (profile) {
                        userProfile = profile;
                        userName = profile.username;
                        updateWelcomeMessage();
                        usernameModal.classList.add('hidden');
                        logoutBtn.classList.remove('hidden');
                    } else {
                        // VeritabanÄ±nda profil yoksa (anormal durum), Ã§Ä±kÄ±ÅŸ yaptÄ±r
                        auth.signOut();
                    }
                } else {
                    // KullanÄ±cÄ± giriÅŸ yapmamÄ±ÅŸ
                    currentUserId = null;
                    userName = '';
                    userProfile = { // Profili sÄ±fÄ±rla
                        username: '',
                        totalScore: 0,
                        unlockedSkins: ['default'],
                        currentSkin: 'default'
                    };
                    welcomeMessage.innerHTML = 'LÃ¼tfen oynamadan Ã¶nce bir kullanÄ±cÄ± adÄ± belirleyin.';
                    welcomeMessage.className = 'mb-6 text-red-400 font-semibold text-lg';
                    startGameBtn.innerHTML = 'Oturum Gerekli';
                    startGameBtn.disabled = true;
                    startGameBtn.classList.add('opacity-50', 'cursor-not-allowed');
                    logoutBtn.classList.add('hidden');
                    
                    // KullanÄ±cÄ± adÄ± modalÄ±nÄ± gÃ¶ster
                    usernameModal.classList.remove('hidden');
                    usernameSubmitBtn.disabled = false;
                    usernameSubmitBtn.textContent = 'Kaydet';
                }
            });
        });

        // --- EVENT LISTENER'LAR ---
        function setupEventListeners() {
            // YENÄ°: KullanÄ±cÄ± adÄ± formu (KayÄ±t/Benzersizlik kontrolÃ¼)
            usernameForm.addEventListener('submit', async function(e) {
                e.preventDefault();
                const requestedUsername = usernameInput.value.trim();
                
                if (requestedUsername.length < 3) {
                    usernameError.textContent = 'KullanÄ±cÄ± adÄ± en az 3 karakter olmalÄ±.';
                    usernameError.classList.remove('hidden');
                    return;
                }

                usernameSubmitBtn.disabled = true;
                usernameSubmitBtn.textContent = 'Kontrol...';
                usernameError.classList.add('hidden');

                try {
                    const exists = await firebaseAPI.checkUsernameExists(requestedUsername);
                    
                    if (exists) {
                        // KullanÄ±cÄ± adÄ± alÄ±nmÄ±ÅŸ
                        usernameError.textContent = 'Bu kullanÄ±cÄ± adÄ± zaten alÄ±nmÄ±ÅŸ. BaÅŸka bir tane dene.';
                        usernameError.classList.remove('hidden');
                        usernameSubmitBtn.disabled = false;
                        usernameSubmitBtn.textContent = 'Kaydet';
                    } else {
                        // KullanÄ±cÄ± adÄ± uygun, kayÄ±t iÅŸlemi
                        usernameSubmitBtn.textContent = 'Kaydediliyor...';
                        
                        // Ã–nce anonim olarak giriÅŸ yap
                        const userCredential = await auth.signInAnonymously();
                        const uid = userCredential.user.uid;
                        
                        // Sonra profili oluÅŸtur
                        const newProfile = await firebaseAPI.createUserProfile(uid, requestedUsername);
                        
                        // Global deÄŸiÅŸkenleri ayarla (onAuthStateChanged de tetiklenecek ama
                        // biz yine de anÄ±nda gÃ¼ncelleyelim)
                        currentUserId = uid;
                        userProfile = newProfile;
                        userName = newProfile.username;
                        
                        updateWelcomeMessage();
                        usernameModal.classList.add('hidden');
                        logoutBtn.classList.remove('hidden');
                    }
                } catch (error) {
                    console.error("KayÄ±t hatasÄ±:", error);
                    usernameError.textContent = 'Bir hata oluÅŸtu. LÃ¼tfen tekrar deneyin.';
                    usernameError.classList.remove('hidden');
                    usernameSubmitBtn.disabled = false;
                    usernameSubmitBtn.textContent = 'Kaydet';
                }
            });
            
            // Menu Buttons
            startGameBtn.addEventListener('click', startGame);
            document.getElementById('rankingBtn').addEventListener('click', showRanking);
            document.getElementById('marketBtn').addEventListener('click', showMarket);
            document.getElementById('aboutBtn').addEventListener('click', showAbout);
            logoutBtn.addEventListener('click', () => auth.signOut()); // Ã‡Ä±kÄ±ÅŸ yap
            
            // Game Over Buttons
            document.getElementById('returnToMenuBtn').addEventListener('click', returnToMenu);
            document.getElementById('viewRankingBtn').addEventListener('click', showRanking);
            
            // Modal Close Buttons
            document.getElementById('closeRankingModal').addEventListener('click', () => rankingModal.classList.add('hidden'));
            document.getElementById('closeMarketModal').addEventListener('click', () => marketModal.classList.add('hidden'));
            document.getElementById('closeAboutModal').addEventListener('click', () => aboutModal.classList.add('hidden'));
        }

        // --- EKRAN YÃ–NETÄ°MÄ° ---
        function showScreen(screen) {
            menuScreen.classList.add('hidden');
            gameScreen.classList.add('hidden');
            gameOverScreen.classList.add('hidden');
            
            if (screen === 'menu') {
                menuScreen.classList.remove('hidden');
            } else if (screen === 'game') {
                gameScreen.classList.remove('hidden');
            } else if (screen === 'gameOver') {
                gameOverScreen.classList.remove('hidden');
            }
        }

        function updateWelcomeMessage() {
            if (userName) {
                welcomeMessage.innerHTML = `HOÅ GELDÄ°N, <span class='text-yellow-300 uppercase'>${userName}</span>!<div class='text-base text-gray-400 mt-1'>Toplam Puan: <span class='text-yellow-500'>${userProfile.totalScore}</span></div>`;
                welcomeMessage.className = 'mb-6 text-green-400 font-semibold text-lg animate-fade-in';
                startGameBtn.innerHTML = 'ğŸš€ Oyuna BaÅŸla';
                startGameBtn.disabled = false;
                startGameBtn.classList.remove('opacity-50', 'cursor-not-allowed');
            }
        }

        // --- OYUN FONKSÄ°YONLARI ---
        function startGame() {
            if (!currentUserId) return; // GiriÅŸ yapÄ±lmadÄ±ysa baÅŸlatma
            
            gameVars.score = 0;
            gameVars.lives = INITIAL_HEALTH;
            gameVars.enemies = [];
            gameVars.bullets = [];
            gameVars.timeLeft = GAME_DURATION;
            gameVars.lastEnemyTime = 0;
            
            gameVars.ultiReady = true;
            gameVars.isShieldActive = false;
            gameVars.isRapidFireActive = false;
            gameVars.lastUltiTime = 0;
            updateUltiUI(); 
            
            scoreValue.textContent = '0';
            livesValue.textContent = INITIAL_HEALTH;
            
            const allDynamicElements = gameArea.querySelectorAll('.enemy, .bullet, .explosion, .meteor');
            allDynamicElements.forEach(el => el.remove());
            
            player.style.left = (gameArea.offsetWidth / 2) - (player.offsetWidth / 2) + 'px';
            gameVars.playerX = (gameArea.offsetWidth / 2) - (player.offsetWidth / 2);
            player.style.border = '3px solid transparent'; 
            
            const skinColor = SKIN_PRICES.find(s => s.id === userProfile.currentSkin)?.color || '#3b82f6';
            player.style.setProperty('--skin-color', skinColor);
            player.style.boxShadow = `0 0 20px ${skinColor}`; 
            
            showScreen('game');
            gameVars.gameActive = true;
            
            gameLoop();
            
            document.addEventListener('mousemove', handleMouseMove);
            gameArea.addEventListener('click', activateUlti); 
            
            gameVars.timerInterval = setInterval(() => {
                if (!gameVars.gameActive) return;
                
                gameVars.timeLeft--;
                
                if (gameVars.timeLeft <= 0) {
                    endGame();
                }
            }, 1000);
        }

        async function endGame() { // YENÄ°: Fonksiyon async oldu
            gameVars.gameActive = false;
            cancelAnimationFrame(gameVars.animationId);
            clearInterval(gameVars.timerInterval);
            document.removeEventListener('mousemove', handleMouseMove);
            gameArea.removeEventListener('click', activateUlti); 
            
            ultiDisplay.classList.add('hidden');
            
            const dynamicElements = gameArea.querySelectorAll('.enemy, .bullet, .explosion, .meteor');
            dynamicElements.forEach(el => el.remove());
            
            // Skoru gÃ¼ncelle
            finalScore.textContent = gameVars.score;
            
            // YENÄ°: Skoru Firebase'e kaydet
            if (gameVars.score > 0) {
                // Toplam skoru gÃ¼ncelle
                userProfile.totalScore += gameVars.score;
                totalScore.textContent = userProfile.totalScore;
                
                // Asenkron olarak veritabanÄ±na kaydet
                try {
                    await firebaseAPI.saveGameScore(userName, gameVars.score);
                    await firebaseAPI.updateTotalScore(currentUserId, userProfile.totalScore);
                } catch (error) {
                    console.error("Skor kaydetme hatasÄ±:", error);
                }
            }
            
            // EkranÄ± deÄŸiÅŸtir
            showScreen('gameOver');
        }

        function returnToMenu() {
            showScreen('menu');
            // MenÃ¼ye dÃ¶nÃ¼nce hoÅŸ geldin mesajÄ±nÄ± da gÃ¼ncelle (yeni toplam puanÄ± gÃ¶stersin)
            updateWelcomeMessage();
        }

        // --- OYUN MANTIÄI ---
        function gameLoop() {
            if (!gameVars.gameActive) {
                return;
            }
            
            const currentTime = Date.now();
            
            if (!gameVars.ultiReady) {
                const timeSinceUlti = Date.now() - gameVars.lastUltiTime;
                if (timeSinceUlti > ULTI_COOLDOWN) {
                    gameVars.ultiReady = true;
                    updateUltiUI();
                }
            }
            
            const elapsedSeconds = GAME_DURATION - gameVars.timeLeft;
            const difficultyMultiplier = 1 + (elapsedSeconds / GAME_DURATION) * 0.8; 
            const currentSpawnInterval = ENEMY_SPAWN_INTERVAL / difficultyMultiplier; 
            
            if (currentTime - gameVars.lastEnemyTime > currentSpawnInterval) {
                createEnemy(difficultyMultiplier); 
                gameVars.lastEnemyTime = currentTime;
            }
            
            const currentBulletInterval = gameVars.isRapidFireActive ? 50 : BULLET_SPAWN_INTERVAL;
            if (currentTime - gameVars.lastBulletTime > currentBulletInterval) {
                createBullet();
                gameVars.lastBulletTime = currentTime;
            }
            
            moveEnemies();
            moveBullets();
            checkCollisions();
            
            gameVars.animationId = requestAnimationFrame(gameLoop);
        }

        function handleMouseMove(e) {
            if (!gameVars.gameActive) return;
            
            const gameRect = gameArea.getBoundingClientRect();
            let newPlayerX = e.clientX - gameRect.left - player.offsetWidth / 2;
            
            if (newPlayerX < 0) newPlayerX = 0;
            if (newPlayerX > gameRect.width - player.offsetWidth) {
                newPlayerX = gameRect.width - player.offsetWidth;
            }
            
            gameVars.playerX = newPlayerX;
            player.style.left = newPlayerX + 'px';
        }

        function createStars() {
            starsContainer.innerHTML = '';
            for (let i = 0; i < 100; i++) {
                const star = document.createElement('div');
                star.className = 'star';
                star.style.width = Math.random() * 3 + 'px';
                star.style.height = star.style.width;
                star.style.left = Math.random() * 100 + '%';
                star.style.top = Math.random() * 100 + '%';
                star.style.animationDelay = Math.random() * 5 + 's';
                starsContainer.appendChild(star);
            }
        }

        function createEnemy(multiplier = 1) {
            const isMeteor = Math.random() < 0.15; 
            
            const element = document.createElement('div');
            let speed, width, height;

            if (isMeteor) {
                element.className = 'meteor';
                width = 20;
                height = 60;
                speed = (3 + Math.random() * 3) * multiplier; 
            } else {
                element.className = 'enemy';
                width = 40;
                height = 40;
                speed = (1 + Math.random() * 2) * multiplier;
            }
            
            element.style.left = Math.random() * (gameArea.offsetWidth - width) + 'px';
            element.style.top = `-${height}px`;
            gameArea.appendChild(element);
            
            gameVars.enemies.push({
                element: element,
                x: parseInt(element.style.left),
                y: -height,
                speed: speed,
                width: width,
                height: height,
                isMeteor: isMeteor
            });
        }

        function createBullet() {
            if (!player || !gameVars.gameActive) return;
            
            const bullet = document.createElement('div');
            bullet.className = 'bullet';
            
            const bulletX = gameVars.playerX + player.offsetWidth / 2 - 2.5;
            const bulletY = player.offsetTop - 15;
            
            bullet.style.left = bulletX + 'px';
            bullet.style.top = bulletY + 'px';
            gameArea.appendChild(bullet);
            
            gameVars.bullets.push({
                element: bullet,
                x: bulletX,
                y: bulletY,
                speed: 15,
                width: 5,
                height: 15
            });
        }

        function moveEnemies() {
            for (let i = gameVars.enemies.length - 1; i >= 0; i--) {
                const enemy = gameVars.enemies[i];
                enemy.y += enemy.speed;
                enemy.element.style.top = enemy.y + 'px';
                
                if (enemy.y > gameArea.offsetHeight) {
                    enemy.element.remove();
                    gameVars.enemies.splice(i, 1);
                    if (!gameVars.isShieldActive) {
                        loseLife(enemy.isMeteor ? 2 : 1); 
                    }
                }
            }
        }

        function moveBullets() {
            for (let i = gameVars.bullets.length - 1; i >= 0; i--) {
                const bullet = gameVars.bullets[i];
                bullet.y -= bullet.speed;
                bullet.element.style.top = bullet.y + 'px';
                
                if (bullet.y < -15) {
                    bullet.element.remove();
                    gameVars.bullets.splice(i, 1);
                }
            }
        }

        function checkCollisions() {
            // Mermi-DÃ¼ÅŸman
            for (let i = gameVars.bullets.length - 1; i >= 0; i--) {
                const bullet = gameVars.bullets[i];
                
                for (let j = gameVars.enemies.length - 1; j >= 0; j--) {
                    const enemy = gameVars.enemies[j];
                    
                    if (
                        bullet.x < enemy.x + enemy.width &&
                        bullet.x + bullet.width > enemy.x &&
                        bullet.y < enemy.y + enemy.height &&
                        bullet.y + bullet.height > enemy.y
                    ) {
                        createExplosion(enemy.x + enemy.width / 2, enemy.y + enemy.height / 2);
                        bullet.element.remove();
                        gameVars.bullets.splice(i, 1);
                        enemy.element.remove();
                        gameVars.enemies.splice(j, 1);
                        gameVars.score += (enemy.isMeteor ? SCORE_MULTIPLIER * 2 : SCORE_MULTIPLIER);
                        scoreValue.textContent = gameVars.score;
                        break;
                    }
                }
            }
            
            if (gameVars.isShieldActive) return;

            // Oyuncu-DÃ¼ÅŸman
            const playerWidth = 60;
            const playerHeight = 60;
            const playerY = player.offsetTop;
            
            for (let i = gameVars.enemies.length - 1; i >= 0; i--) {
                const enemy = gameVars.enemies[i];
                
                if (
                    gameVars.playerX < enemy.x + enemy.width &&
                    gameVars.playerX + playerWidth > enemy.x &&
                    playerY < enemy.y + enemy.height &&
                    playerY + playerHeight > enemy.y
                ) {
                    createExplosion(enemy.x + enemy.width / 2, enemy.y + enemy.height / 2);
                    enemy.element.remove();
                    gameVars.enemies.splice(i, 1);
                    loseLife(enemy.isMeteor ? 2 : 1);
                    break;
                }
            }
        }

        function loseLife(amount = 1) {
            if (!gameVars.gameActive) return;
            gameVars.lives -= amount;
            
            if (gameVars.lives < 0) {
                 gameVars.lives = 0;
            }
            livesValue.textContent = gameVars.lives;
            
            if (gameVars.lives <= 0) {
                endGame();
            }
        }

        function createExplosion(x, y) {
            const explosion = document.createElement('div');
            explosion.className = 'explosion';
            explosion.style.left = (x - 25) + 'px';
            explosion.style.top = (y - 25) + 'px';
            gameArea.appendChild(explosion);
            
            setTimeout(() => {
                explosion.remove();
            }, 500);
        }

        // --- ULTÄ° FONKSÄ°YONLARI ---

        function updateUltiUI() {
            ultiDisplay.classList.toggle('hidden', userProfile.currentSkin === 'default');

            if (gameVars.ultiReady) {
                ultiStatus.textContent = 'HAZIR';
                ultiDisplay.classList.remove('cooling-down');
            } else {
                ultiStatus.textContent = 'KULLANILDI';
                ultiDisplay.classList.add('cooling-down');
            }
        }

        function activateUlti() {
            if (!gameVars.gameActive || !gameVars.ultiReady || userProfile.currentSkin === 'default') {
                return;
            }
            
            gameVars.ultiReady = false;
            gameVars.lastUltiTime = Date.now();
            updateUltiUI();
            
            switch (userProfile.currentSkin) {
                case 'red_fighter':
                    ulti_RapidFire();
                    break;
                case 'green_defender':
                    ulti_Shield();
                    break;
                case 'yellow_blaster':
                    ulti_Nuke();
                    break;
            }
        }

        function ulti_Nuke() {
            const enemiesToExplode = [...gameVars.enemies];
            enemiesToExplode.forEach(enemy => {
                createExplosion(enemy.x + enemy.width / 2, enemy.y + enemy.height / 2);
                gameVars.score += (enemy.isMeteor ? SCORE_MULTIPLIER * 2 : SCORE_MULTIPLIER);
            });
            gameArea.querySelectorAll('.enemy, .meteor').forEach(el => el.remove());
            gameVars.enemies = [];
            scoreValue.textContent = gameVars.score;
        }

        function ulti_Shield() {
            gameVars.isShieldActive = true;
            player.style.boxShadow = '0 0 40px #00ffff';
            player.style.border = '3px solid #00ffff';

            setTimeout(() => {
                gameVars.isShieldActive = false;
                const skinColor = SKIN_PRICES.find(s => s.id === userProfile.currentSkin)?.color || '#3b82f6';
                player.style.boxShadow = `0 0 20px ${skinColor}`;
                player.style.border = '3px solid transparent';
            }, 5000); 
        }

        function ulti_RapidFire() {
            gameVars.isRapidFireActive = true;
            setTimeout(() => {
                gameVars.isRapidFireActive = false;
            }, 3000);
        }


        // --- MODAL FONKSÄ°YONLARI ---
        async function showRanking() { // YENÄ°: async oldu
            rankingModal.classList.remove('hidden');
            const rankingContent = document.getElementById('rankingContent');
            rankingContent.innerHTML = '<div class="text-center py-8 text-blue-400">SÄ±ralama yÃ¼kleniyor...</div>';

            try {
                // YENÄ°: SÄ±ralamayÄ± Firebase'den Ã§ek
                const highScores = await firebaseAPI.getHighScores();
                
                if (highScores.length === 0) {
                     rankingContent.innerHTML = '<div class="text-center py-8 text-gray-400">HenÃ¼z hiÃ§ skor kaydedilmemiÅŸ.</div>';
                     return;
                }

                let rankingHTML = `
                    <div class="overflow-x-auto">
                        <table class="min-w-full divide-y divide-gray-700">
                            <thead>
                                <tr class="text-left text-gray-400 text-sm">
                                    <th class="px-4 py-2">SÄ±ra</th>
                                    <th class="px-4 py-2">KullanÄ±cÄ± AdÄ±</th>
                                    <th class="px-4 py-2 text-right">YÃ¼ksek Skor</th>
                                    <th class="px-4 py-2 text-right">Oynanma ZamanÄ±</th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-gray-800">
                `;
                
                highScores.forEach((entry, index) => {
                    // Firebase timestamp'ini Date nesnesine Ã§evir
                    const date = entry.timestamp ? entry.timestamp.toDate().toLocaleDateString('tr-TR') : 'Bilinmiyor';
                    const isCurrentUser = entry.username === userName;
                    
                    rankingHTML += `
                        <tr class="transition-all duration-300 ${isCurrentUser ? 'bg-blue-900/50 text-yellow-400 font-bold' : 'text-gray-200 hover:bg-gray-700/50'}">
                            <td class="px-4 py-2">${index + 1}</td>
                            <td class="px-4 py-2">${entry.username}</td>
                            <td class="px-4 py-2 text-right">${entry.score}</td>
                            <td class="px-4 py-2 text-right text-xs">${date}</td>
                        </tr>
                    `;
                });
                
                rankingHTML += `</tbody></table></div>`;
                rankingContent.innerHTML = rankingHTML;

            } catch (error) {
                console.error("SÄ±ralama yÃ¼klenemedi:", error);
                rankingContent.innerHTML = '<div class="text-center py-8 text-red-400">SÄ±ralama yÃ¼klenirken bir hata oluÅŸtu.</div>';
            }
        }

        function showMarket() {
            if (!currentUserId) {
                // GiriÅŸ yapÄ±lmadÄ±ysa marketi gÃ¶stermeden Ã¶nce uyar
                alert("Marketi gÃ¶rmek iÃ§in Ã¶nce bir kullanÄ±cÄ± adÄ± oluÅŸturmalÄ±sÄ±n.");
                return;
            }
            marketModal.classList.remove('hidden');
            totalScore.textContent = userProfile.totalScore;
            loadSkins();
        }

        function loadSkins() {
            skinsContainer.innerHTML = '';
            
            SKIN_PRICES.forEach(skin => {
                const isUnlocked = userProfile.unlockedSkins.includes(skin.id);
                const isEquipped = skin.id === userProfile.currentSkin;
                
                const skinElement = document.createElement('div');
                skinElement.className = `p-4 rounded-lg flex justify-between items-center transition-all duration-300 ${isEquipped ? 'bg-blue-900/70 border-2 border-yellow-500' : 'bg-gray-700 hover:bg-gray-600'}`;
                
                skinElement.innerHTML = `
                    <div class="flex flex-col">
                        <span class="${isEquipped ? 'text-yellow-300' : 'text-white'} text-xl font-extrabold">${skin.name}</span>
                        <span class="text-sm text-gray-400">
                            ${isUnlocked ? 'AÃ‡IK' : `Fiyat: ${skin.price} Puan`}
                        </span>
                    </div>
                    <div id="skinBtn-${skin.id}">
                        ${isEquipped 
                            ? '<button class="px-4 py-2 rounded-lg font-bold bg-green-600 text-white opacity-50 cursor-not-allowed" disabled>AKTÄ°F</button>' 
                            : isUnlocked 
                                ? `<button class="px-4 py-2 rounded-lg font-bold bg-indigo-600 text-white hover:bg-indigo-700" onclick="equipSkin('${skin.id}')">KUÅAN</button>`
                                : `<button class="px-4 py-2 rounded-lg font-bold bg-indigo-600 text-white hover:bg-indigo-700 ${userProfile.totalScore < skin.price ? 'opacity-50 cursor-not-allowed' : ''}" ${userProfile.totalScore < skin.price ? 'disabled' : ''} onclick="buySkin('${skin.id}')">${userProfile.totalScore < skin.price ? 'YETERSÄ°Z' : 'SATIN AL'}</button>`
                        }
                    </div>
                `;
                
                skinsContainer.appendChild(skinElement);
            });
        }

        async function buySkin(skinId) { // YENÄ°: async oldu
            const skin = SKIN_PRICES.find(s => s.id === skinId);
            if (!skin || !currentUserId) return;
            
            if (userProfile.totalScore >= skin.price) {
                userProfile.totalScore -= skin.price;
                userProfile.unlockedSkins.push(skinId);
                totalScore.textContent = userProfile.totalScore;
                
                // DeÄŸiÅŸiklikleri Firebase'e kaydet
                try {
                    await firebaseAPI.saveUserProfileData(currentUserId, {
                        totalScore: userProfile.totalScore,
                        unlockedSkins: userProfile.unlockedSkins
                    });
                } catch (error) {
                    console.error("Skin alÄ±mÄ± kaydedilemedi:", error);
                    // Hata durumunda (isteÄŸe baÄŸlÄ±) iÅŸlemi geri alabilirsin
                }
                
                loadSkins(); // Marketi yenile
            }
        }

        async function equipSkin(skinId) { // YENÄ°: async oldu
            if (userProfile.unlockedSkins.includes(skinId) && currentUserId) {
                userProfile.currentSkin = skinId;
                
                // DeÄŸiÅŸikliÄŸi Firebase'e kaydet
                try {
                    await firebaseAPI.saveUserProfileData(currentUserId, {
                        currentSkin: skinId
                    });
                } catch (error) {
                    console.error("Skin kuÅŸanma kaydedilemedi:", error);
                }
                
                loadSkins(); // Marketi yenile
                
                // Gemi rengini anÄ±nda deÄŸiÅŸtir (eÄŸer oyun alanÄ±ndaysa)
                if (gameVars.gameActive) {
                    const skinColor = SKIN_PRICES.find(s => s.id === skinId)?.color || '#3b82f6';
                    player.style.setProperty('--skin-color', skinColor);
                    player.style.boxShadow = `0 0 20px ${skinColor}`;
                    player.style.border = '3px solid transparent';
                }
            }
        }

        function showAbout() {
            // DÃœZELTÄ°LDÄ°: 'hidden' sÄ±nÄ±fÄ±nÄ± kaldÄ±r
            aboutModal.classList.remove('hidden');
        }
    </script>
</body>
</html>
